/* ===== Nier Automata palette mapped onto your cyberpunk layout classes ===== */
:root {
    --colors-bg--500: #ccc7b1;   /* overall background */
    --colors-bg--300: #e4e0c0;   /* panels */
    --colors-primary--600: #6b6450; /* borders/stripes */
    --colors-primary--500: #4e493a; /* ink */
    --colors-secondary--500: #beb89f; /* muted beige highlights */
    --colors-tertiary--500: #a59e83; /* shadow line */
    --colors-on_bg--500: #4e493a;    /* text on bg */
    --colors-on_primary--500: #e4e0c0; /* text on primary */
    --fonts-primary: 'Raleway', sans-serif;
    --fonts-secondary: 'Raleway', sans-serif;
    --ui-glow: none;
    --ui-glow-text: none;
    --ui-glow-text--dimmed: none;
    --ui-elevation--1: 2px 2px 0 rgba(0,0,0,0.15);
    --ui-notch-amount: 1rem;
    --ui-notch-hypotenuse: 22.627416px;
    --ui-notch-path: polygon(0 0,100% 0,100% calc(100% - var(--ui-notch-amount) + 2px),calc(100% - var(--ui-notch-amount) + 2px) 100%,0 100%);
  }
  
  /* Global */
  html, body {
    margin: 0;
    background: var(--colors-bg--500);
    color: var(--colors-on_bg--500);
    font-family: var(--fonts-primary);
    text-transform: uppercase;
    min-height: 100vh;
  }
  
  .app-skeleton { padding: 0 1rem; min-width: 1024px; height: 100vh; }
  
  /* Header */
  .app-header {
    display:flex; align-items:center; justify-content:space-between;
    margin-bottom:1rem; padding:1rem 0 .5rem 0; position:relative;
  }
  .app-header::after {
    content:""; position:absolute; left:0; right:0; bottom:0;
    height:2px; background: var(--colors-primary--500); opacity:.7;
  }
  .app-header__anchor__text { letter-spacing:.1rem; }
  
  /* Top nav */
  .nav { list-style:none; padding:0; margin:0; }
  .app-header .nav { display:flex; align-items:flex-end; }
  .app-header .nav__item + .nav__item { margin-left: 2rem; }
  .app-header .nav__link {
    display:flex; align-items:baseline; text-transform:uppercase;
    transition: opacity .2s ease;
  }
  .app-header .nav__link.nav__link--active { color: var(--colors-primary--500); opacity:1; }
  .app-header .nav__link:not(.nav__link--active) { opacity:.7; }
  
  /* 3-column layout */
  .app-container {
    display:grid; grid-gap:1rem;
    grid-template-areas: "a main main main side";
    grid-template-columns: 280px 1fr 1fr 1fr 320px;
    height: calc(100% - 5.25rem);
  }
  .app-a { grid-area:a; }
  .app-main { grid-area:main; }
  .app-b { grid-area:side; }
  
  /* Segment topbar */
  .segment-topbar { display:flex; justify-content:space-between; margin-bottom:1rem; position:relative; min-height:3.5rem; }
  .segment-topbar::after { content:""; position:absolute; left:0; right:0; bottom:0; height:1px; background: var(--colors-primary--500); opacity:.7; }
  .segment-topbar__overline { font-family: var(--fonts-secondary); letter-spacing:.08rem; opacity:.75; }
  
  /* Buttons */
  .button {
    display:inline-block; text-transform:uppercase; padding:.45rem;
    border:1px solid var(--colors-primary--500); color: var(--colors-primary--500);
    background: transparent; cursor: default;
  }
  .button--primary { border-color: var(--colors-secondary--500); color: var(--colors-primary--500); }
  .button--size-lg, .button--size-xl { border-width:2px; padding:.55rem .9rem; }
  .button__icon { width:1.125rem; height:1.125rem; fill: currentcolor; }
  
  /* Left nav sections */
  .nav-section__header { background: var(--colors-bg--300); border:1px solid var(--colors-primary--600); border-radius:3px; margin-bottom:.5rem; padding:.5rem .75rem; }
  .nav-section__title { margin:0; color: var(--colors-primary--500); }
  .nav-section__body { padding-left: 1rem; }
  
  .nav-section .nav__item + .nav__item { margin-top:.125rem; }
  .nav-section .nav__link {
    display:block; padding:.5rem .75rem; border: 1px solid transparent;
    color: var(--colors-primary--500); background: var(--colors-secondary--500); opacity:.9;
  }
  .nav-section .nav__link:hover,
  .nav-section .nav__link.nav__link--active {
    background: var(--colors-primary--500); color: var(--colors-bg--300);
    border-color: var(--colors-primary--600);
  }
  
  /* Channel/Conversation link bits */
  .channel-link, .conversation-link { display:flex; align-items:center; }
  .channel-link__icon, .conversation-link__icon { margin-right:.75rem; }
  .channel-link__icon { font-weight:bold; }
  .conversation-link__icon::after {
    content:""; display:block; width:.5em; height:.5em; border-radius:50%;
    background: var(--colors-secondary--500);
  }
  .conversation-link--online .conversation-link__icon::after { background: var(--colors-primary--600); }
  .conversation-link--unread, .channel-link--unread { font-weight:bold; }
  
  /* Badge */
  .badge {
    border: 1.5px solid var(--colors-tertiary--500);
    color: var(--colors-primary--500);
    border-radius:3px; padding:.15em .34em; font-size:.92rem; line-height:1;
  }
  
  /* Pad / panels */
  .pad { background: var(--colors-bg--300); border: 2px solid var(--colors-primary--600); clip-path: var(--ui-notch-path); }
  .pad__body { padding:.75rem; padding-bottom: var(--ui-notch-amount); }
  .pad::before {
    content:""; position:absolute; right:-6px; bottom:5px; width: var(--ui-notch-hypotenuse); height:3px;
    background: var(--colors-primary--600); transform: rotate(-45deg); z-index: 100;
  }
  
  /* Feed (middle) */
  .channel-feed { display:flex; flex-direction:column; height:100%; }
  .channel-feed__body { flex:1; overflow:auto; padding-right:.25rem; }
  .message { padding-bottom:1rem; }
  .message__body {
    background: var(--colors-bg--300);
    border:1px solid var(--colors-tertiary--500);
    color: var(--colors-primary--500);
    padding:.75rem; border-radius:3px;
  }
  .message__footer { color: var(--colors-primary--500); font-size:.85rem; margin-top:.25rem; }
  .message--self .message__body { background: #d8d4ba; border-color: var(--colors-primary--600); }
  
  /* Form (static) */
  .form-label {
    display:inline-block; padding:.125em .75em; padding-right:2em; background: var(--colors-primary--600);
    color: var(--colors-bg--300); font-family: var(--fonts-secondary); letter-spacing:.065em; clip-path: polygon(0.25em 0, calc(100% - 1em) 0, 100% 100%, 0.33em 100%, 0 100%, 0 0.25em);
  }
  .form-control { background: var(--colors-bg--300); border:1px solid var(--colors-primary--600); clip-path: var(--ui-notch-path); }
  .form-control::before {
    content:""; position:absolute; right:-6px; bottom:5px; width: var(--ui-notch-hypotenuse); height:3px;
    background: var(--colors-primary--600); transform: rotate(-45deg); z-index: 100;
  }
  .form-control input, .form-control textarea {
    background: transparent; border:0; color: var(--colors-primary--500);
    font-family: var(--fonts-primary); font-size:1rem; letter-spacing:.045em; padding:.5rem; outline:none; resize:none;
  }
  .channel-message-form textarea[disabled], .form-search input[disabled] { opacity:.6; cursor:not-allowed; }
  
  /* Right panel links (yellow emphasis on <em> only) */
  .lethal-link em {
    color: #fed33f;
    text-decoration: none;
    font-style: italic;
  }
  .lethal-link em:hover { text-shadow: 0 0 6px rgba(254,211,63,.7); }
  
  /* Typography helpers */
  .text-heading3, .text-heading4, .segment-topbar__overline, .text-paragraph1 { text-transform: inherit; }
  .text-heading3 { font-size:1.125rem; margin:0; letter-spacing:.06rem; }
  .text-heading4 { font-size:1rem; margin:.25rem 0 0 0; letter-spacing:.06rem; }
  .segment-topbar__title { text-shadow: none; }
  
  /* Make the search bar slimmer */
.form-search {
    margin: 0.5rem 0; /* reduce spacing above/below */
  }
  
  .form-search .form-control {
    height: 28px;      /* thinner box */
    padding: 2px 6px;  /* smaller padding */
    font-size: 0.75rem; /* smaller text */
  }
  
  .form-search input {
    font-size: 0.75rem;
    padding: 2px 4px;
  }
  
  /* Make the addon (magnifying glass) sit on the right */
.form-control--with-addon {
    position: relative;
  }
  
  .form-control__addon--prefix {
    position: absolute;
    right: 6px;       /* push it all the way to the right */
    top: 50%;         /* center vertically */
    transform: translateY(-50%);
    pointer-events: none; /* icon shouldn't block clicks */
  }
  
  .form-control__addon--prefix .button__icon {
    width: 14px;      /* scale icon smaller */
    height: 14px;
    opacity: 0.7;     /* subtle, nier-style */
  }
  

/* ===== Extreme glitch layers ===== */

/* ASCII rain container */
.ascii-rain {
  position: absolute;
  inset: 0;
  pointer-events: none;
  mix-blend-mode: multiply;
  opacity: .9;
  z-index: 3;
}
.ascii-col {
  position: absolute;
  top: -110%;
  white-space: pre;
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  font-size: 12px;
  line-height: 1.1;
  color: rgba(78,73,58,.75);             /* Nier text tone */
  text-shadow: 0 0 1px rgba(0,0,0,.25);
  animation: asciiFall linear infinite;
}
@keyframes asciiFall {
  0%   { transform: translateY(0) }
  100% { transform: translateY(220%) }
}

/* Code bursts (escaped lines) */
.code-burst {
  position: absolute;
  z-index: 4;
  color: #7b0000;
  background: rgba(187, 144, 144, 0.65);
  border-left: 4px solid #6b6450;
  padding: 2px 6px;
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
  font-size: 12px;
  letter-spacing: .02em;
  box-shadow: 2px 2px 0 0 rgba(0,0,0,.12);
  filter: blur(.1px) contrast(1.05);
  animation: burstBlink 460ms steps(2) 0s 5, burstFade .28s linear 1s forwards;
}
@keyframes burstBlink {
  0%,100%{ opacity: .75; }
  50%    { opacity: 1;    }
}
@keyframes burstFade {
  to { opacity: 0; transform: translateY(-2px); }
}

/* Tear bars â€” hard horizontal shifts */
.tear-bars { position: absolute; inset: 0; z-index: 5; pointer-events: none; }
.tear-bar {
  position: absolute; left: -10%;
  right: -10%;
  background:
    linear-gradient(90deg, rgba(173, 173, 173, 0.279), rgba(255, 0, 0, 0.106), rgba(0, 0, 255, 0.205));
  mix-blend-mode: multiply;
  animation-name: tearShift;
  animation-iteration-count: 6;
  animation-timing-function: steps(2);
  
}
@keyframes tearShift {
  0%   { transform: translateX(0); }
  50%  { transform: translateX(var(--shift, 8px)); }
  100% { transform: translateX(0); }
}

/* Make overlay more dramatic on extreme mode */
.glitch-active #glitch-overlay .glitch-noise {
  opacity: 2;
  animation-duration: 90ms;
}

.glitch-active .app-skeleton {
  animation:
    jitterX 60ms steps(2) 0s 8,
    jitterY 70ms steps(2) 0s 8,
    hueNudge 160ms linear 0s 4;
}

/* Reduce motion fallback */
@media (prefers-reduced-motion: reduce) {
  .ascii-rain, .code-burst, .tear-bar {
    animation: none !important;
  }
}

